#TODO:extract functions from views and put them here